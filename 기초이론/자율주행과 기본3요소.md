# 자율주행이란?

<br>

### 0. 왜 필요한가?

- 운전자가 운전에 개입하지 않을 경우 사고는 줄어들 것이라는 기대
- 지금까진 기술적 문제가 있다고 봐서, 유인운전과 크게 다르지 않음 (사고 발생률)
- 아직은 단점이 많이 보이지만 자율주행의 기술의 향상에 대한 기대치가 높기도 하고,

  지속적인 연구가 필요

<br>

<br>

### 1. 자율주행 단계

![img](https://user-images.githubusercontent.com/89068148/186194580-521f96ce-e140-4a57-8080-eeb23808e2fe.jpg)

![제목 없음](https://user-images.githubusercontent.com/89068148/186194841-6a29f045-e8d8-4e39-99a9-9f8bae392e54.png)

- SAE(Society of Automative Engineers)에서 정의
  - 레벨0 : 운전자가 차량을 제어
  - 레벨1 : 자율주행 시스템은 운전자를 보조, 시스템이 제한된 상황에서 속도나 조향을 하는 단계
  - 레벨2 : 시스템이 조향과 속도를 제어
  - 레벨3 : 비상시에만 운전자가 개입하고, 제한된 조건에서 차량이 자율적으로 주행
  - 레벨4 : 운전석이 필요없으며, 시스템이 특정지역에서 자율적으로 운행
  - 레벨5 : 레벨4와 같지만 모든 지역에 해당
- 현재 자율주행 단계는 2~3단계 수준에 머물러 있음

<br>

<br>

### 2. 자율주행 3단계 핵심기술

<br>

#### 1. 인지 Object Detection

- **Classification** - 라벨링

  **Localization** - 객체가 어디있는지 bounding box 지정 

  **Detection** - 이미지 내에서 여러 객체들을 찾아내는 것

<br>

- **Deep learning object detection**

  - 자율주행에 빠질 수 없는 요소

  - 자율주행 자동차는 **주변환경인지, 주행 도로 판단과 선정, 안전한 기능 제어** 등 세가지 기능이 반드시

    수반되어야 한다.

    딮러닝은 3가지 모두에 활용될 수 있다.

<br>

- 정밀도로 지도

  - **가외성 redundancy**

    - 자율주행이나 불확실성에서는 가외성(중첩성)을 만족시키며 운행하는것이 중요함.

      받아온 데이터를 정밀지도와 한번 더 검증 및 확인

  - 도로의 경사나 곡률, 정지선 위치 등 사전에 알고 있기 때문에 사전행동 가능, 연비주행 가능(미리 악셀 발 떼는)

  - 센서 만으로는 갑작스러운 상황 대비 불가능 > 정밀지도와 **v2x**(실시간 동적인 정보까지 가능) 로 보완 가능 

  - **정밀지도 종류**

    - Point Cloud Map

      - 3차원 좌표를 가진 점들로 불규칙하게 구성된 데이터 (점구름, 점군데이터)

        자율주행에서 라이다 센서나 RGB-D 센서 등으로 수집된 데이터를 의미함

      - 물체에 빛/신호를 보내서 돌아오는 시간을 기록 및 빛/신호 당 거리 정보를 계산하여 포인트로 생성

        이러한 포인트들이 3차원 공간상에 퍼져있는 집합

    - HD Map (Vector Map)

      - 신호등, 차선, 교차로 등을 벡터 데이터로 표현하여 지도로 만든것

      - 포인트 클라우드가 형상만 있고, 차선 등의 정보가 없는 것에 비해 hp map의 경우

        주행에 의미있는 정보를 표현

      - 차선등의 정보가 자율주행 차량의 성능에 큰 영향을 미침

    - Grid Map

      - 격자 지도로 자료가 격자의 형태로 전달되어지는 지도
      - 경로 계획이나 경로 생성등에 많이 사용된다.
      - 포인트 클라우드 맵보다 상대적으로 용량이 작기 때문에 공간을 표현하는 정밀도가 떨어진다.

<br>

- **센서**

  - 카메라

    다양한 정보를 얻을 수 있지만, 객체 인식을 위해선 여러 연산이 필요함

    밤이나 악천후 에는 정보의 품질이 떨어지기 쉬움

  - 라이다

    주변환경 360도 인식

    레이저 (빛) 을 매개체로 사물 간 거리 및 형태를 파악

    정밀하지만, 가격이 비싸고 외부 환경에 영향을 많이 받음

    큰 외향과 에너지 소비율 때문에 많이 채택되지 않았지만, 최근 라이다 센서의 지속 발전으로

    개선되고 있음

  - 레이더

    전파를 매개체로 사물간 거리 및 형태 파악

    라이다 센서보다 정밀도가 떨어지지만, 소형화가 가능하고, 보다 저렴하며, 악천후에 강함

    사이즈가 곧 성능

    작은 물체는 식별이 어렵고 정밀한 이미지 제공에 제한

    최대 측정 거리에 반비례하여 측정거리가 줄어드는 특징이 있음

<br>

<br>

#### 2. 판단

- **1) 경로계획** 안전한가? 최적화?

  - 전역 경로 계획

    지도에 디반하여 경로를 자율적으로 생성

    - 주행 기록을 이용한 전역경로 생성

      가장 직관적인 방법은 직접 주행하여 차량의 위치 좌표들을 기록하는것

      기록된 차량의 위치정보 하나하나가 웨이포인트

  - 지역 경로 계획

    전체 경로에서 일부분을 수정하여 계획하는것 (장애물, 교통량 등)

<br>

- **2) 경로생성**

  - 궤적 : 차선변경이나 경로를 변경하기 위해서 필요

    - 가장 쉬운 방법은 시작점과 끝점 잇기

      ![제목 없음](https://user-images.githubusercontent.com/89068148/186332786-1750c33b-e87e-4710-bace-192a60921247.png)

      차선 변경이 시작하는 순간과 완료 시점에서 큰 각도 변화가 이루어짐 > 안정성 저하

      갑작스러운 큰 조향각을 줄이는 것이 좋음

    - 3차 궤적 함수가 필요함

      ![제목 없음](https://user-images.githubusercontent.com/89068148/186335742-cd01cea3-98d1-4f88-b196-da061c76501d.png)

      3차 곡선의 경우 매 순간 각도의 변화량이 존재하여 차선변경의 시작점과 끝점에서

      큰 각도 변화를 피할 수 있었음

  - **Pure pursuit guidance : 이곳말고 purePursuit.md 참조 **


<br>

<br>

#### 3. 제어

##### - PID 제어 (별도 자료 참고)

<br>

<br>

#### 4. 정리

![제목 없음](https://user-images.githubusercontent.com/89068148/186594014-70417207-7c76-4e9e-a3cc-71d75e2eff87.png)

<br>

---

